<!DOCTYPE html>
<html>
<head>
<title>Estimate Storage</title>
</head>
<body>

    <p>Estimated storage usage is <b id="usage">unknown</b> bytes.</p>
    <p>Estimated storage quota is <b id="quota">unknown</b> bytes.</p>
    <p>Estimated usage is <b id="percent">unknown</b>%.</p>
    <p>Persistent storage status is <b id="persisted">unknown</b>.</p>
    <p><button onclick="requestPersistence()">Request persistent storage</button></p>

<script>
    if ('storage' in navigator && 'estimate' in navigator.storage) {
  navigator.storage.estimate()
    .then(estimate => {
      document.getElementById('usage').innerHTML = estimate.usage;
      document.getElementById('quota').innerHTML = estimate.quota;
      document.getElementById('percent').innerHTML = (estimate.usage * 100 / estimate.quota).toFixed(0);
    });
}

if ('storage' in navigator && 'persisted' in navigator.storage) {
  navigator.storage.persisted()
    .then(persisted => {
      document.getElementById('persisted').innerHTML = persisted ? 'persisted' : 'not persisted';
    });
}

function requestPersistence() {
  if ('storage' in navigator && 'persist' in navigator.storage) {
    navigator.storage.persist()
      .then(persisted => {
        document.getElementById('persisted').innerHTML = persisted ? 'persisted' : 'not persisted';
      });
  }
}
</script>
</body>
</html>
